{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/GREESHRAJ PATAIRIYA/Desktop/Temp/Kgpian_chat/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/GREESHRAJ PATAIRIYA/Desktop/Temp/Kgpian_chat/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/GREESHRAJ PATAIRIYA/Desktop/Temp/Kgpian_chat/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import{Box,Button,Stack,Text,useDisclosure,useToast}from\"@chakra-ui/react\";import{AddIcon}from\"@chakra-ui/icons\";import{ChatState}from\"../context/ChatProvider\";import ChatLoading from\"./ChatLoading\";import{getSender}from\"../config/ChatLogics\";import GroupChatModal from\"./miscellaneous/GroupChatModal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MyChats=function MyChats(_ref){var fetchAgain=_ref.fetchAgain;var _useState=useState(),_useState2=_slicedToArray(_useState,2),loggedUser=_useState2[0],setLoggedUser=_useState2[1];var _ChatState=ChatState(),selectedChat=_ChatState.selectedChat,setSelectedChat=_ChatState.setSelectedChat,user=_ChatState.user,chats=_ChatState.chats,setChats=_ChatState.setChats;var toast=useToast();var _useDisclosure=useDisclosure(),onClose=_useDisclosure.onClose;var fetchChats=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"/api/chat\",{method:\"GET\",headers:{Authorization:\"Bearer \".concat(user.token)}});case 3:response=_context.sent;_context.next=6;return response.json();case 6:data=_context.sent;setChats(data);onClose();// Close the side drawer\n_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);return _context.abrupt(\"return\",toast({title:\"Error Occured!\",description:\"Failed to Load the Search Results\",status:\"error\",duration:5000,isClosable:true,position:\"bottom-left\",variant:\"solid\"}));case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function fetchChats(){return _ref2.apply(this,arguments);};}();useEffect(function(){setLoggedUser(JSON.parse(localStorage.getItem(\"userInfo\")));fetchChats();// eslint-disable-next-line\n},[fetchAgain]);return/*#__PURE__*/_jsxs(Box,{display:{base:selectedChat?\"none\":\"flex\",md:\"flex\"},flexDir:\"column\",alignItems:\"center\",p:3,bg:\"white\",w:{base:\"100%\",md:\"31%\"},borderRadius:\"lg\",borderWidth:\"1px\",children:[/*#__PURE__*/_jsx(Box,{pb:3,px:3,fontSize:{base:\"28px\",md:\"30px\"},fontFamily:\"Work sans\",display:\"flex\",w:\"100%\",justifyContent:\"space-between\",alignItems:\"center\",children:\"My Chats\"}),/*#__PURE__*/_jsx(Box,{display:\"flex\",flexDir:\"column\",p:3,bg:\"#F8F8F8\",w:\"100%\",h:\"100%\",borderRadius:\"lg\",overflowY:\"hidden\",children:chats?/*#__PURE__*/_jsx(Stack,{overflowY:\"scroll\",children:chats.map(function(chat){return/*#__PURE__*/_jsx(Box,{onClick:function onClick(){return setSelectedChat(chat);},cursor:\"pointer\",bg:selectedChat===chat?\"#38B2AC\":\"#E8E8E8\",color:selectedChat===chat?\"white\":\"black\",px:3,py:2,borderRadius:\"lg\",children:/*#__PURE__*/_jsx(Text,{children:!chat.isGroupChat?getSender(loggedUser,chat.users):chat.chatName})},chat._id);})}):/*#__PURE__*/_jsx(ChatLoading,{})})]});};export default MyChats;","map":{"version":3,"names":["useEffect","useState","Box","Button","Stack","Text","useDisclosure","useToast","AddIcon","ChatState","ChatLoading","getSender","GroupChatModal","MyChats","fetchAgain","loggedUser","setLoggedUser","selectedChat","setSelectedChat","user","chats","setChats","toast","onClose","fetchChats","fetch","method","headers","Authorization","token","response","json","data","title","description","status","duration","isClosable","position","variant","JSON","parse","localStorage","getItem","base","md","map","chat","isGroupChat","users","chatName","_id"],"sources":["C:/Users/GREESHRAJ PATAIRIYA/Desktop/Temp/Kgpian_chat/client/src/components/MyChats.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport {\r\n  Box,\r\n  Button,\r\n  Stack,\r\n  Text,\r\n  useDisclosure,\r\n  useToast,\r\n} from \"@chakra-ui/react\";\r\nimport { AddIcon } from \"@chakra-ui/icons\";\r\n\r\nimport { ChatState } from \"../context/ChatProvider\";\r\nimport ChatLoading from \"./ChatLoading\";\r\nimport { getSender } from \"../config/ChatLogics\";\r\nimport GroupChatModal from \"./miscellaneous/GroupChatModal\";\r\n\r\nconst MyChats = ({ fetchAgain }) => {\r\n  const [loggedUser, setLoggedUser] = useState();\r\n\r\n  const { selectedChat, setSelectedChat, user, chats, setChats } = ChatState();\r\n  const toast = useToast();\r\n  const { onClose } = useDisclosure();\r\n\r\n  const fetchChats = async () => {\r\n    try {\r\n      const response = await fetch(`/api/chat`, {\r\n        method: \"GET\",\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      });\r\n      const data = await response.json();\r\n\r\n      setChats(data);\r\n      onClose(); // Close the side drawer\r\n    } catch (error) {\r\n      return toast({\r\n        title: \"Error Occured!\",\r\n        description: \"Failed to Load the Search Results\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n        variant: \"solid\",\r\n      });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    setLoggedUser(JSON.parse(localStorage.getItem(\"userInfo\")));\r\n    fetchChats();\r\n    // eslint-disable-next-line\r\n  }, [fetchAgain]);\r\n\r\n  return (\r\n    <Box\r\n      display={{ base: selectedChat ? \"none\" : \"flex\", md: \"flex\" }}\r\n      flexDir=\"column\"\r\n      alignItems=\"center\"\r\n      p={3}\r\n      bg=\"white\"\r\n      w={{ base: \"100%\", md: \"31%\" }}\r\n      borderRadius=\"lg\"\r\n      borderWidth=\"1px\"\r\n    >\r\n      <Box\r\n        pb={3}\r\n        px={3}\r\n        fontSize={{ base: \"28px\", md: \"30px\" }}\r\n        fontFamily=\"Work sans\"\r\n        display=\"flex\"\r\n        w=\"100%\"\r\n        justifyContent=\"space-between\"\r\n        alignItems=\"center\"\r\n      >\r\n        My Chats\r\n        {/* <GroupChatModal>\r\n          <Button\r\n            display=\"flex\"\r\n            fontSize={{ base: \"17px\", md: \"10px\", lg: \"17px\" }}\r\n            rightIcon={<AddIcon />}\r\n          >\r\n            New Group Chat\r\n          </Button>\r\n        </GroupChatModal> */}\r\n      </Box>\r\n\r\n      <Box\r\n        display=\"flex\"\r\n        flexDir=\"column\"\r\n        p={3}\r\n        bg=\"#F8F8F8\"\r\n        w=\"100%\"\r\n        h=\"100%\"\r\n        borderRadius=\"lg\"\r\n        overflowY=\"hidden\"\r\n      >\r\n        {chats ? (\r\n          <Stack overflowY=\"scroll\">\r\n            {chats.map((chat) => (\r\n              <Box\r\n                onClick={() => setSelectedChat(chat)}\r\n                cursor=\"pointer\"\r\n                bg={selectedChat === chat ? \"#38B2AC\" : \"#E8E8E8\"}\r\n                color={selectedChat === chat ? \"white\" : \"black\"}\r\n                px={3}\r\n                py={2}\r\n                borderRadius=\"lg\"\r\n                key={chat._id}\r\n              >\r\n                <Text>\r\n                  {!chat.isGroupChat\r\n                    ? getSender(loggedUser, chat.users)\r\n                    : chat.chatName}\r\n                </Text>\r\n              </Box>\r\n            ))}\r\n          </Stack>\r\n        ) : (\r\n          <ChatLoading />\r\n        )}\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default MyChats;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}